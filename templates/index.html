<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">

    <!-- Evita flash blanco al cargar -->
    <script>
    (function () {
        const theme = localStorage.getItem("theme");
        if (theme === "dark") {
            document.documentElement.classList.add("dark");
        }
    })();
    </script>

    <title>{{ nombre }} | Pok√©mon Aleatorio</title>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='menu.css') }}">

</head>

<body>

<div class="card">

 <!-- HAMBURGER MENU -->
    <div class="menu-container">
        <button id="menu-btn" aria-label="Abrir men√∫">‚ò∞</button>

        <div id="side-menu" class="side-menu">
            <h3>Filtros</h3>

            <label>
            <input type="checkbox" id="filter-legendary">
            Solo legendarios
            </label>

            <div class="menu-actions">
            <button id="apply-filters">Aplicar filtros</button>
            <button id="clear-filters">Limpiar</button>
            </div>

            <hr>

            <button id="toggle-dark">üåô Modo oscuro</button>
        </div>
    </div>

    <div class="header">
        <h1>üéÆ Pok√©mon Aleatorio</h1>
    </div>

    <div class="pokemon-img">
        <img src="{{ imagen_url }}" alt="Pokemon">
    </div>

    <div class="name {% if es_legendario %}legendary{% endif %}">
        {{ nombre }}
    </div>

    <div class="badges">
        {% for tipo in tipos %}
            <div class="badge type-{{ tipo }}">{{ tipo }}</div>
        {% endfor %}
    </div>

    <div class="info">
        <strong>Generaci√≥n:</strong> {{ generacion }}
    </div>

    <div class="stats-box">
        <div class="stat">
            <div class="stat-label">üìè Altura</div>
            <div class="stat-value">{{ altura }} m</div>
        </div>
        <div class="stat">
            <div class="stat-label">‚öñÔ∏è Peso</div>
            <div class="stat-value">{{ peso }} kg</div>
        </div>
    </div>

    <div class="info">
        <strong>Mega evoluci√≥n:</strong>
        {% if mega_disponible %} ‚úÖ {% else %} ‚ùå {% endif %}
    </div>

    <div class="info">
        <strong>Legendario:</strong>
        {% if es_legendario %} ‚úÖ {% else %} ‚ùå {% endif %}
    </div>

    <div class="evo-tree">
        <h3>Cadena evolutiva</h3>

        {% for origen, ramas in evoluciones_por_origen.items() %}
        <div class="evo-node">

            {% if loop.first %}
            <div class="pokemon-box evo-click" data-name="{{ origen }}">
                {{ origen.capitalize() }}
            </div>
            {% endif %}

            {% for evo in ramas %}
            <div class="evo-lineal">
                <div class="pokemon-box child evo-click" data-name="{{ evo.to }}">
                    {{ evo.to.capitalize() }}

                    {% if evo.condiciones %}
                        <div class="evo-conditions">
                            {% for c in evo.condiciones %}
                                <div class="condition">{{ c }}</div>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>
            {% endfor %}

        </div>
        {% endfor %}
    </div>

    <form method="get">
        <button>üé≤ Nuevo Pok√©mon</button>
    </form>
</div>

<div id="modal-bg">
    <div id="modal-card">
        <img id="modal-img" src="">
        <h3 id="modal-name"></h3>
    </div>
</div>

<!-- JS externo -->
<script src="{{ url_for('static', filename='main.js') }}"></script>
<script src="{{ url_for('static', filename='menu.js') }}"></script>

</body>
</html>
